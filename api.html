<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Sheets Data</title>
</head>
<body>
    <h2>table</h2>
    <table id="dataTable" border="1">
        <!-- Table header will be filled dynamically -->
    </table>

    <script>
        // Replace with your own Google Sheets URL
        const sheetUrl = 'https://docs.google.com/spreadsheets/d/1f_LvY4rqE3k0WYEmtkb6ZkTxVVqnbblO5LGSW9Bivlk/edit?usp=sharing';

        // Load Google Sheets API
        function loadSheetsAPI() {
            gapi.client.load("https://content.googleapis.com/discovery/v1/apis/sheets/v4/rest")
                .then(() => {
                    console.log("GAPI client loaded for API");
                    fetchSheetData();
                }, (error) => {
                    console.error("Error loading GAPI client for API", error);
                });
        }

        // Fetch data from Google Sheet
        function fetchSheetData() {
            gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: '1f_LvY4rqE3k0WYEmtkb6ZkTxVVqnbblO5LGSW9Bivlk',
                range: 'Students' // Change 'Sheet1' to your actual sheet name
            }).then(function(response) {
                const data = response.result.values;
                if (data.length > 0) {
                    displayData(data);
                } else {
                    console.log('No data found.');
                }
            }, function(response) {
                console.error('Error fetching data from Google Sheets:', response.result.error);
            });
        }

        // Display data on HTML page
        function displayData(data) {
            const dataTable = document.getElementById('dataTable');

            // Clear existing data
            dataTable.innerHTML = '';

            // Create table header
            const headerRow = document.createElement('tr');
            data[0].forEach(function(cellData) {
                const th = document.createElement('th');
                th.textContent = cellData;
                headerRow.appendChild(th);
            });
            dataTable.appendChild(headerRow);

            // Create table rows
            for (let i = 1; i < data.length; i++) {
                const row = document.createElement('tr');
                data[i].forEach(function(cellData) {
                    const td = document.createElement('td');
                    td.textContent = cellData;
                    row.appendChild(td);
                });
                dataTable.appendChild(row);
            }
        }

        // Initialize Google Sheets API
        function init() {
            gapi.client.init({
                apiKey: 'AIzaSyDSJbTjOlHO6CaZD21audvJq8iXo1ecGdc', // Replace with your Google API key
                discoveryDocs: ["https://sheets.googleapis.com/$discovery/rest?version=v4"],
            }).then(loadSheetsAPI, function(error) {
                console.error('Error initializing Google API client:', error);
            });
        }
    </script>
    <script src="https://apis.google.com/js/api.js?onload=init"></script>
</body>
</html>
